version: "3.1"
flows:
  book_hotel:
    description: "Help the user book a hotel room"
    steps:
      - collect: location
      - collect: check_in
      - collect: check_out
      - collect: num_guests
        id: step_num_guests
        rejections:
          - if: "slots.num_guests >= 25"
            utter: utter_too_many_guests
      - collect: num_rooms
        id: step_num_rooms
        rejections:
          - if: "slots.num_rooms >= 10"
            utter: utter_too_many_rooms
      
      # --- NEW LOGIC STARTS HERE ---
      - action: utter_booking_summary
        id: step_show_summary

      - collect: confirm_booking
        description: "Ask the user if the details are correct"
        next:
          - if: "not slots.confirm_booking"
            then:
              - action: utter_ask_for_changes
              - set_slots:
                  - confirm_booking: null # Reset so they can confirm again later
                next: step_show_summary  # Jumps back to redisplay the updated info
          - else: END # Continues to final action or finish